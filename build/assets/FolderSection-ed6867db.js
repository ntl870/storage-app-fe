import{r as m,A as ce,_ as W,ac as Be,ad as ze,ae as Le,af as H,i as Ae,m as je,ag as Ge,k as Z,ah as de,n as ee,ai as _e,aj as He,ak as We,q as ue,al as Ve,am as Qe,an as qe,ao as Xe,a as e,u as U,ap as Je,aq as Ke,ar as Ye,as as Ze,D as J,B as E,j as x,at as he,au as eo,av as oo,aw as ao,ax as to,R as oe,C as V,ay as ae,az as no,Q as te,J as K,aA as ro,aB as io,F as B,T as N,z as L,G as A,E as j,aC as lo,aD as so,O as ge,P as me,Y as be,aE as fe,s as co,aF as uo,aG as ho,aH as go,aI as mo,y as ye,x as bo,a7 as ve,aJ as pe,aK as Q,aL as Ce,aM as Ie,aN as fo,aO as yo,aP as vo,aQ as po,aR as Co,aS as Io,aT as So,aU as Do}from"./index-69c07cab.js";import{F as wo,a as ko,c as Se,e as De,b as xo}from"./index.es-1f96d64b.js";import{a as Ro,S as _,D as we,L as M,F as ke}from"./index-8f3045ac.js";import{M as z}from"./index-7ac34a3a.js";import{m as xe}from"./index-cfb25278.js";import{D as Re}from"./DeleteOutlined-286cb938.js";import{s as Mo}from"./styled-components.browser.esm-d2f299d7.js";import{E as Oo}from"./index-488b9160.js";var To={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M624 706.3h-74.1V464c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v242.3H400c-6.7 0-10.4 7.7-6.3 12.9l112 141.7a8 8 0 0012.6 0l112-141.7c4.1-5.2.4-12.9-6.3-12.9z"}},{tag:"path",attrs:{d:"M811.4 366.7C765.6 245.9 648.9 160 512.2 160S258.8 245.8 213 366.6C127.3 389.1 64 467.2 64 560c0 110.5 89.5 200 199.9 200H304c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8h-40.1c-33.7 0-65.4-13.4-89-37.7-23.5-24.2-36-56.8-34.9-90.6.9-26.4 9.9-51.2 26.2-72.1 16.7-21.3 40.1-36.8 66.1-43.7l37.9-9.9 13.9-36.6c8.6-22.8 20.6-44.1 35.7-63.4a245.6 245.6 0 0152.4-49.9c41.1-28.9 89.5-44.2 140-44.2s98.9 15.3 140 44.2c19.9 14 37.5 30.8 52.4 49.9 15.1 19.3 27.1 40.7 35.7 63.4l13.8 36.5 37.8 10C846.1 454.5 884 503.8 884 560c0 33.1-12.9 64.3-36.3 87.7a123.07 123.07 0 01-87.6 36.3H720c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h40.1C870.5 760 960 670.5 960 560c0-92.7-63.1-170.7-148.6-193.3z"}}]},name:"cloud-download",theme:"outlined"};const Fo=To;var Me=function(r,l){return m.createElement(ce,W(W({},r),{},{ref:l,icon:Fo}))};Me.displayName="CloudDownloadOutlined";const Oe=m.forwardRef(Me);var Po={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M574 665.4a8.03 8.03 0 00-11.3 0L446.5 781.6c-53.8 53.8-144.6 59.5-204 0-59.5-59.5-53.8-150.2 0-204l116.2-116.2c3.1-3.1 3.1-8.2 0-11.3l-39.8-39.8a8.03 8.03 0 00-11.3 0L191.4 526.5c-84.6 84.6-84.6 221.5 0 306s221.5 84.6 306 0l116.2-116.2c3.1-3.1 3.1-8.2 0-11.3L574 665.4zm258.6-474c-84.6-84.6-221.5-84.6-306 0L410.3 307.6a8.03 8.03 0 000 11.3l39.7 39.7c3.1 3.1 8.2 3.1 11.3 0l116.2-116.2c53.8-53.8 144.6-59.5 204 0 59.5 59.5 53.8 150.2 0 204L665.3 562.6a8.03 8.03 0 000 11.3l39.8 39.8c3.1 3.1 8.2 3.1 11.3 0l116.2-116.2c84.5-84.6 84.5-221.5 0-306.1zM610.1 372.3a8.03 8.03 0 00-11.3 0L372.3 598.7a8.03 8.03 0 000 11.3l39.6 39.6c3.1 3.1 8.2 3.1 11.3 0l226.4-226.4c3.1-3.1 3.1-8.2 0-11.3l-39.5-39.6z"}}]},name:"link",theme:"outlined"};const $o=Po;var Te=function(r,l){return m.createElement(ce,W(W({},r),{},{ref:l,icon:$o}))};Te.displayName="LinkOutlined";const Fe=m.forwardRef(Te);var No=["refetch","reobserve","fetchMore","updateQuery","startPolling","subscribeToMore"];function Eo(o,r){var l,t=m.useRef(new Set),n=m.useRef(),v=n.current?Be(r,n.current):r,f=ze(Le(r&&r.client),(l=v==null?void 0:v.query)!==null&&l!==void 0?l:o),h=f.useQuery(H(H({},v),{skip:!n.current})),a=h.observable.options.initialFetchPolicy||f.getDefaultFetchPolicy(),C=Object.assign(h,{called:!!n.current}),b=m.useMemo(function(){for(var c={},y=function(u){var s=C[u];c[u]=function(){return n.current||(n.current=Object.create(null),f.forceUpdate()),s.apply(this,arguments)}},I=0,w=No;I<w.length;I++){var p=w[I];y(p)}return c},[]);Object.assign(C,b),m.useEffect(function(){return function(){t.current.forEach(function(c){c.abort()})}},[]);var S=m.useCallback(function(c){var y=new AbortController;t.current.add(y),n.current=c?H(H({},c),{fetchPolicy:c.fetchPolicy||a}):{fetchPolicy:a};var I=f.asyncUpdate(y.signal).then(function(w){return t.current.delete(y),Object.assign(w,b)});return I.catch(function(){t.current.delete(y)}),I},[]);return[S,C]}const Uo=new Ge("antRadioEffect",{"0%":{transform:"scale(1)",opacity:.5},"100%":{transform:"scale(1.6)",opacity:0}}),Bo=o=>{const{componentCls:r,antCls:l}=o,t=`${r}-group`;return{[t]:Object.assign(Object.assign({},Z(o)),{display:"inline-block",fontSize:0,[`&${t}-rtl`]:{direction:"rtl"},[`${l}-badge ${l}-badge-count`]:{zIndex:1},[`> ${l}-badge:not(:first-child) > ${l}-button-wrapper`]:{borderInlineStart:"none"}})}},zo=o=>{const{componentCls:r,radioWrapperMarginRight:l,radioCheckedColor:t,radioSize:n,motionDurationSlow:v,motionDurationMid:f,motionEaseInOut:h,motionEaseInOutCirc:a,radioButtonBg:C,colorBorder:b,lineWidth:S,radioDotSize:c,colorBgContainerDisabled:y,colorTextDisabled:I,paddingXS:w,radioDotDisabledColor:p,lineType:u,radioDotDisabledSize:s,wireframe:i,colorWhite:D}=o,d=`${r}-inner`;return{[`${r}-wrapper`]:Object.assign(Object.assign({},Z(o)),{position:"relative",display:"inline-flex",alignItems:"baseline",marginInlineStart:0,marginInlineEnd:l,cursor:"pointer",[`&${r}-wrapper-rtl`]:{direction:"rtl"},"&-disabled":{cursor:"not-allowed",color:o.colorTextDisabled},"&::after":{display:"inline-block",width:0,overflow:"hidden",content:'"\\a0"'},[`${r}-checked::after`]:{position:"absolute",insetBlockStart:0,insetInlineStart:0,width:"100%",height:"100%",border:`${S}px ${u} ${t}`,borderRadius:"50%",visibility:"hidden",animationName:Uo,animationDuration:v,animationTimingFunction:h,animationFillMode:"both",content:'""'},[r]:Object.assign(Object.assign({},Z(o)),{position:"relative",display:"inline-block",outline:"none",cursor:"pointer",alignSelf:"center"}),[`${r}-wrapper:hover &,
        &:hover ${d}`]:{borderColor:t},[`${r}-input:focus-visible + ${d}`]:Object.assign({},de(o)),[`${r}:hover::after, ${r}-wrapper:hover &::after`]:{visibility:"visible"},[`${r}-inner`]:{"&::after":{boxSizing:"border-box",position:"absolute",insetBlockStart:"50%",insetInlineStart:"50%",display:"block",width:n,height:n,marginBlockStart:n/-2,marginInlineStart:n/-2,backgroundColor:i?t:D,borderBlockStart:0,borderInlineStart:0,borderRadius:n,transform:"scale(0)",opacity:0,transition:`all ${v} ${a}`,content:'""'},boxSizing:"border-box",position:"relative",insetBlockStart:0,insetInlineStart:0,display:"block",width:n,height:n,backgroundColor:C,borderColor:b,borderStyle:"solid",borderWidth:S,borderRadius:"50%",transition:`all ${f}`},[`${r}-input`]:{position:"absolute",insetBlockStart:0,insetInlineEnd:0,insetBlockEnd:0,insetInlineStart:0,zIndex:1,cursor:"pointer",opacity:0},[`${r}-checked`]:{[d]:{borderColor:t,backgroundColor:i?C:t,"&::after":{transform:`scale(${c/n})`,opacity:1,transition:`all ${v} ${a}`}}},[`${r}-disabled`]:{cursor:"not-allowed",[d]:{backgroundColor:y,borderColor:b,cursor:"not-allowed","&::after":{backgroundColor:p}},[`${r}-input`]:{cursor:"not-allowed"},[`${r}-disabled + span`]:{color:I,cursor:"not-allowed"},[`&${r}-checked`]:{[d]:{"&::after":{transform:`scale(${s/n})`}}}},[`span${r} + *`]:{paddingInlineStart:w,paddingInlineEnd:w}})}},Lo=o=>{const{radioButtonColor:r,controlHeight:l,componentCls:t,lineWidth:n,lineType:v,colorBorder:f,motionDurationSlow:h,motionDurationMid:a,radioButtonPaddingHorizontal:C,fontSize:b,radioButtonBg:S,fontSizeLG:c,controlHeightLG:y,controlHeightSM:I,paddingXS:w,borderRadius:p,borderRadiusSM:u,borderRadiusLG:s,radioCheckedColor:i,radioButtonCheckedBg:D,radioButtonHoverColor:d,radioButtonActiveColor:g,radioSolidCheckedColor:O,colorTextDisabled:P,colorBgContainerDisabled:F,radioDisabledButtonCheckedColor:k,radioDisabledButtonCheckedBg:R}=o;return{[`${t}-button-wrapper`]:{position:"relative",display:"inline-block",height:l,margin:0,paddingInline:C,paddingBlock:0,color:r,fontSize:b,lineHeight:`${l-n*2}px`,background:S,border:`${n}px ${v} ${f}`,borderBlockStartWidth:n+.02,borderInlineStartWidth:0,borderInlineEndWidth:n,cursor:"pointer",transition:[`color ${a}`,`background ${a}`,`border-color ${a}`,`box-shadow ${a}`].join(","),a:{color:r},[`> ${t}-button`]:{position:"absolute",insetBlockStart:0,insetInlineStart:0,zIndex:-1,width:"100%",height:"100%"},"&:not(:first-child)":{"&::before":{position:"absolute",insetBlockStart:-n,insetInlineStart:-n,display:"block",boxSizing:"content-box",width:1,height:"100%",paddingBlock:n,paddingInline:0,backgroundColor:f,transition:`background-color ${h}`,content:'""'}},"&:first-child":{borderInlineStart:`${n}px ${v} ${f}`,borderStartStartRadius:p,borderEndStartRadius:p},"&:last-child":{borderStartEndRadius:p,borderEndEndRadius:p},"&:first-child:last-child":{borderRadius:p},[`${t}-group-large &`]:{height:y,fontSize:c,lineHeight:`${y-n*2}px`,"&:first-child":{borderStartStartRadius:s,borderEndStartRadius:s},"&:last-child":{borderStartEndRadius:s,borderEndEndRadius:s}},[`${t}-group-small &`]:{height:I,paddingInline:w-n,paddingBlock:0,lineHeight:`${I-n*2}px`,"&:first-child":{borderStartStartRadius:u,borderEndStartRadius:u},"&:last-child":{borderStartEndRadius:u,borderEndEndRadius:u}},"&:hover":{position:"relative",color:i},"&:has(:focus-visible)":Object.assign({},de(o)),[`${t}-inner, input[type='checkbox'], input[type='radio']`]:{width:0,height:0,opacity:0,pointerEvents:"none"},[`&-checked:not(${t}-button-wrapper-disabled)`]:{zIndex:1,color:i,background:D,borderColor:i,"&::before":{backgroundColor:i},"&:first-child":{borderColor:i},"&:hover":{color:d,borderColor:d,"&::before":{backgroundColor:d}},"&:active":{color:g,borderColor:g,"&::before":{backgroundColor:g}}},[`${t}-group-solid &-checked:not(${t}-button-wrapper-disabled)`]:{color:O,background:i,borderColor:i,"&:hover":{color:O,background:d,borderColor:d},"&:active":{color:O,background:g,borderColor:g}},"&-disabled":{color:P,backgroundColor:F,borderColor:f,cursor:"not-allowed","&:first-child, &:hover":{color:P,backgroundColor:F,borderColor:f}},[`&-disabled${t}-button-wrapper-checked`]:{color:k,backgroundColor:R,borderColor:f,boxShadow:"none"}}}},Pe=Ae("Radio",o=>{const{padding:r,lineWidth:l,controlItemBgActiveDisabled:t,colorTextDisabled:n,colorBgContainer:v,fontSizeLG:f,controlOutline:h,colorPrimaryHover:a,colorPrimaryActive:C,colorText:b,colorPrimary:S,marginXS:c,controlOutlineWidth:y,colorTextLightSolid:I,wireframe:w}=o,p=`0 0 0 ${y}px ${h}`,u=p,s=f,i=4,D=s-i*2,d=w?D:s-(i+l)*2,g=S,O=b,P=a,F=C,k=r-l,T=je(o,{radioFocusShadow:p,radioButtonFocusShadow:u,radioSize:s,radioDotSize:d,radioDotDisabledSize:D,radioCheckedColor:g,radioDotDisabledColor:n,radioSolidCheckedColor:I,radioButtonBg:v,radioButtonCheckedBg:v,radioButtonColor:O,radioButtonHoverColor:P,radioButtonActiveColor:F,radioButtonPaddingHorizontal:k,radioDisabledButtonCheckedBg:t,radioDisabledButtonCheckedColor:n,radioWrapperMarginRight:c});return[Bo(T),zo(T),Lo(T)]});function Ao(o){return Object.keys(o).reduce((r,l)=>((l.startsWith("data-")||l.startsWith("aria-")||l==="role")&&!l.startsWith("data-__")&&(r[l]=o[l]),r),{})}const $e=m.createContext(null),jo=$e.Provider,Ne=m.createContext(null),Go=Ne.Provider;var _o=globalThis&&globalThis.__rest||function(o,r){var l={};for(var t in o)Object.prototype.hasOwnProperty.call(o,t)&&r.indexOf(t)<0&&(l[t]=o[t]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,t=Object.getOwnPropertySymbols(o);n<t.length;n++)r.indexOf(t[n])<0&&Object.prototype.propertyIsEnumerable.call(o,t[n])&&(l[t[n]]=o[t[n]]);return l};const Ho=(o,r)=>{var l,t;const n=m.useContext($e),v=m.useContext(Ne),{getPrefixCls:f,direction:h}=m.useContext(ee),a=m.useRef(),C=_e(r,a),{isFormItemInput:b}=m.useContext(He),S=F=>{var k,R;(k=o.onChange)===null||k===void 0||k.call(o,F),(R=n==null?void 0:n.onChange)===null||R===void 0||R.call(n,F)},{prefixCls:c,className:y,rootClassName:I,children:w,style:p}=o,u=_o(o,["prefixCls","className","rootClassName","children","style"]),s=f("radio",c),i=((n==null?void 0:n.optionType)||v)==="button"?`${s}-button`:s,[D,d]=Pe(s),g=Object.assign({},u),O=m.useContext(We);n&&(g.name=n.name,g.onChange=S,g.checked=o.value===n.value,g.disabled=(l=g.disabled)!==null&&l!==void 0?l:n.disabled),g.disabled=(t=g.disabled)!==null&&t!==void 0?t:O;const P=ue(`${i}-wrapper`,{[`${i}-wrapper-checked`]:g.checked,[`${i}-wrapper-disabled`]:g.disabled,[`${i}-wrapper-rtl`]:h==="rtl",[`${i}-wrapper-in-form-item`]:b},y,I,d);return D(m.createElement("label",{className:P,style:p,onMouseEnter:o.onMouseEnter,onMouseLeave:o.onMouseLeave},m.createElement(Ve,Object.assign({},g,{type:"radio",prefixCls:i,ref:C})),w!==void 0?m.createElement("span",null,w):null))},Wo=m.forwardRef(Ho),q=Wo,Vo=m.forwardRef((o,r)=>{const{getPrefixCls:l,direction:t}=m.useContext(ee),n=m.useContext(Qe),[v,f]=qe(o.defaultValue,{value:o.value}),h=T=>{const Ue=v,ie=T.target.value;"value"in o||f(ie);const{onChange:le}=o;le&&ie!==Ue&&le(T)},{prefixCls:a,className:C,rootClassName:b,options:S,buttonStyle:c="outline",disabled:y,children:I,size:w,style:p,id:u,onMouseEnter:s,onMouseLeave:i,onFocus:D,onBlur:d}=o,g=l("radio",a),O=`${g}-group`,[P,F]=Pe(g);let k=I;S&&S.length>0&&(k=S.map(T=>typeof T=="string"||typeof T=="number"?m.createElement(q,{key:T.toString(),prefixCls:g,disabled:y,value:T,checked:v===T},T):m.createElement(q,{key:`radio-group-value-options-${T.value}`,prefixCls:g,disabled:T.disabled||y,value:T.value,checked:v===T.value,style:T.style},T.label)));const R=w||n,re=ue(O,`${O}-${c}`,{[`${O}-${R}`]:R,[`${O}-rtl`]:t==="rtl"},C,b,F);return P(m.createElement("div",Object.assign({},Ao(o),{className:re,style:p,onMouseEnter:s,onMouseLeave:i,onFocus:D,onBlur:d,id:u,ref:r}),m.createElement(jo,{value:{onChange:h,value:v,disabled:o.disabled,name:o.name,optionType:o.optionType}},k)))}),Qo=m.memo(Vo);var qo=globalThis&&globalThis.__rest||function(o,r){var l={};for(var t in o)Object.prototype.hasOwnProperty.call(o,t)&&r.indexOf(t)<0&&(l[t]=o[t]);if(o!=null&&typeof Object.getOwnPropertySymbols=="function")for(var n=0,t=Object.getOwnPropertySymbols(o);n<t.length;n++)r.indexOf(t[n])<0&&Object.prototype.propertyIsEnumerable.call(o,t[n])&&(l[t[n]]=o[t[n]]);return l};const Xo=(o,r)=>{const{getPrefixCls:l}=m.useContext(ee),{prefixCls:t}=o,n=qo(o,["prefixCls"]),v=l("radio",t);return m.createElement(Go,{value:"button"},m.createElement(q,Object.assign({prefixCls:v},n,{type:"radio",ref:r})))},Jo=m.forwardRef(Xo),Y=q;Y.Button=Jo;Y.Group=Qo;Y.__ANT_RADIO=!0;const G=Y,se={page:1,limit:20},ne=({debounceTimeout:o=800,query:r,format:l,queryOptionsVariables:t,onChange:n,multiple:v,...f})=>{const[h,a]=m.useState([]),[C,b]=m.useState(!1),[S,c]=m.useState(se),[y,I]=m.useState(!0),[w]=Eo(r),[p,u]=m.useState(""),s=d=>{w({variables:t?{...t,search:d,...S}:{search:d,...S},fetchPolicy:"cache-and-network"}).then(g=>{var P,F,k;const O=Object.keys(g.data)[0];a((F=(P=g.data[O])==null?void 0:P.results)==null?void 0:F.map(l)),I((k=g.data[O])==null?void 0:k.hasMore)}).finally(()=>{b(!1)})},i=m.useMemo(()=>(c(se),I(!0),Xe(g=>{b(!0),a([]),s(g)},o)),[o]),D=d=>{const g=d.target;g.scrollTop+g.offsetHeight===g.scrollHeight&&y&&c(O=>({...O,page:O.page+1}))};return m.useEffect(()=>{(async()=>{y&&!C&&(b(!0),s(p))})()},[S.page]),e(Ro,{className:"w-full",labelInValue:!0,filterOption:!1,onSearch:d=>{u(d),i(d)},onChange:d=>{n==null||n(d)},showSearch:!0,allowClear:!0,autoClearSearchValue:!0,onPopupScroll:D,notFoundContent:C?e(_,{size:"small"}):e(Oo,{}),loading:C,...f,options:h,mode:v?"multiple":void 0})};var $=(o=>(o.EDITOR="Editor",o.VIEWER="Viewer",o))($||{});const X=({userID:o,initialRole:r,ID:l,type:t,refetchAccessPeople:n})=>{const{showErrorNotification:v,showSuccessNotification:f}=U(),[h,a]=m.useState(r),[C]=Je(),[b]=Ke(),[S]=Ye(),[c]=Ze(),y=async p=>{try{if(t==="folder"){const{data:u}=await C({variables:{targetUserID:o,targetRole:p,folderID:l}});n(),f((u==null?void 0:u.changeUserRoleInFolder)||"")}if(t==="file"){const{data:u}=await b({variables:{targetUserID:o,targetRole:p,fileID:l}});n(),f((u==null?void 0:u.changeUserRoleInFile)||"")}}catch(u){v(u.message)}};return e(J,{menu:{items:[{label:"Editor",key:"0",onClick:async()=>{h!==$.EDITOR&&(a($.EDITOR),await y($.EDITOR))}},{label:"Viewer",key:"1",onClick:async()=>{h!==$.VIEWER&&(a($.VIEWER),await y($.VIEWER))}},{label:"Remove Access",key:"2",onClick:async()=>{try{if(t==="folder"){const{data:p}=await S({variables:{targetUserID:o,folderID:l}});n(),f((p==null?void 0:p.removeUserFromFolder)||"")}if(t==="file"){const{data:p}=await c({variables:{targetUserID:o,fileID:l}});n(),f((p==null?void 0:p.removeUserFromFile)||"")}}catch(p){v(p.message)}}}]},trigger:["click"],children:e(E,{children:x(he,{children:[h,e(we,{})]})})})},Ee=({open:o,handleClose:r,initialUser:l,ID:t,refetchAccessPeople:n,type:v})=>{const{showErrorNotification:f,showSuccessNotification:h}=U(),[a,C]=m.useState("Editor"),[b,S]=m.useState(l),[c,y]=m.useState(!1),[I,w]=m.useState(""),[p]=eo(),[u]=oo(),[s]=ao(),[i]=to(),D=[{label:"Editor",key:"0",onClick:()=>C("Editor")},{label:"Viewer",key:"1",onClick:()=>C("Viewer")}],d=async()=>{try{const k=Array.isArray(b)?b.map(R=>R.value):[String(b==null?void 0:b.value)];if(v==="folder"){const{data:R}=await p({variables:{folderID:t,sharedUserIDs:k,shouldSendMail:c,userMessage:I}});h((R==null?void 0:R.addSharedUserToFolder)||""),n()}if(v==="file"){const{data:R}=await s({variables:{fileID:t,sharedUserIDs:k,shouldSendMail:c,userMessage:I}});h((R==null?void 0:R.addUsersToSharedUserFile)||""),n()}}catch(k){f(k.message)}finally{r()}},g=async()=>{try{const k=Array.isArray(b)?b.map(R=>R.value):[String(b==null?void 0:b.value)];if(v==="folder"){const{data:R}=await u({variables:{folderID:t,readOnlyUserIDs:k,shouldSendMail:c,userMessage:I}});h((R==null?void 0:R.addUserToFolderReadOnlyUsers)||""),n()}if(v==="file"){const{data:R}=await i({variables:{fileID:t,readonlyUserIDs:k,shouldSendMail:c,userMessage:I}});h((R==null?void 0:R.addUsersToReadonlyFile)||""),n()}}catch(k){f(k.message)}finally{r()}},O=()=>{a==="Editor"&&d(),a==="Viewer"&&g()},P=k=>{y(k.target.checked)},F=k=>{w(k.target.value)};return x(z,{title:"Add User",open:o,onCancel:r,centered:!0,onOk:O,children:[x(oe,{gutter:[16,16],children:[e(V,{span:18,children:e(ne,{query:ae,multiple:!0,format:k=>({label:`${k.name} - ${k.email}`,value:k.ID}),onChange:S,value:b})}),e(V,{span:4,children:e(J,{menu:{items:D},trigger:["click"],children:e(E,{children:x(he,{children:[a,e(we,{})]})})})})]}),e(no,{onChange:P,className:"my-4",children:"Notify user via email"}),e(te.TextArea,{placeholder:"Add a message",onChange:F})]})},Ko=({file:o,handleClose:r,open:l})=>{const{ID:t}=K(),{showErrorNotification:n,showSuccessNotification:v}=U(),[f,h]=m.useState(null),[a,C]=m.useState("Private"),[b,{loading:S}]=ro(),{data:c,refetch:y,loading:I}=io({variables:{fileID:(o==null?void 0:o.ID)||""},skip:!(o!=null&&o.ID),onCompleted:s=>{C(s.getPeopleWithAccessToFile.isPublic?"Public":"Private")},fetchPolicy:"cache-and-network"}),w=async s=>{if(C(s),s==="Private")try{await b({variables:{fileID:(o==null?void 0:o.ID)||"",isPublic:!1}}),v("File access changed to private"),C("Private"),y()}catch(i){n(i.message)}if(s==="Public")try{await b({variables:{fileID:(o==null?void 0:o.ID)||"",isPublic:!0}}),v("File access changed to public"),C("Public"),y()}catch(i){n(i.message)}},p=m.useMemo(()=>t===(c==null?void 0:c.getPeopleWithAccessToFile.owner.ID)||(c==null?void 0:c.getPeopleWithAccessToFile.sharedUsers.some(s=>String(s.ID)===t)),[c,t]);return x(B,{children:[e(z,{okButtonProps:{hidden:!0},centered:!0,open:l,onCancel:r,title:"Share file",cancelText:"Close",footer:x(B,{children:[e(E,{icon:e(Fe,{}),onClick:()=>{navigator.clipboard.writeText(`${window.location.origin}/file/${o==null?void 0:o.ID}`),xe.success("Link copied to clipboard")},children:"Copy link"},"copy"),e(E,{type:"primary",onClick:r,children:"Done"},"done")]}),children:I||S?e("div",{className:"text-center",children:e(_,{})}):x(B,{children:[p&&e(ne,{query:ae,format:s=>({label:`${s.name} - ${s.email}`,value:s.ID}),onChange:h}),x("div",{className:"mt-4",children:[e(N.Text,{className:"font-bold",children:"Users can modify"}),(()=>{const s=c==null?void 0:c.getPeopleWithAccessToFile.owner;return e(M,{children:x(M.Item,{children:[e(M.Item.Meta,{avatar:e(L,{size:"large",src:s!=null&&s.avatar?j(s.avatar):A(String(s==null?void 0:s.ID))}),title:s==null?void 0:s.name,description:s==null?void 0:s.email}),e(N.Text,{italic:!0,type:"secondary",className:"text-lg",children:"Owner"})]})})})(),e(M,{itemLayout:"horizontal",className:"max-h-96 overflow-y-auto",dataSource:c==null?void 0:c.getPeopleWithAccessToFile.sharedUsers.filter(s=>s.ID!==c.getPeopleWithAccessToFile.owner.ID),locale:{emptyText:" "},renderItem:s=>x(M.Item,{children:[e(M.Item.Meta,{avatar:e(L,{size:"large",src:s!=null&&s.avatar?j(s.avatar):A(String(s==null?void 0:s.ID))}),title:s==null?void 0:s.name,description:s==null?void 0:s.email}),p&&e(X,{initialRole:$.EDITOR,userID:(s==null?void 0:s.ID)||"",ID:(o==null?void 0:o.ID)||"",type:"file",refetchAccessPeople:y})]})})]}),x("div",{children:[e(N.Text,{className:"font-bold",children:"Users can view"}),e(M,{itemLayout:"horizontal",className:"max-h-96 overflow-y-auto",dataSource:c==null?void 0:c.getPeopleWithAccessToFile.readonlyUsers,renderItem:s=>x(M.Item,{children:[e(M.Item.Meta,{avatar:e(L,{size:"large",src:s.avatar?j(s.avatar):A(String(s.ID))}),title:s.name,description:s.email}),p&&e(X,{initialRole:$.VIEWER,userID:s.ID,ID:(o==null?void 0:o.ID)||"",type:"file",refetchAccessPeople:y})]})})]}),x("div",{className:"flex flex-col",children:[e(N.Text,{className:"font-bold",children:"General Access"}),x(G.Group,{onChange:s=>w(s.target.value),value:a,buttonStyle:"solid",disabled:!p,children:[e(G.Button,{value:"Public",className:"w-1/2 text-center",children:"Public"}),e(G.Button,{value:"Private",className:"w-1/2 text-center",children:"Private"})]})]})]})}),!!f&&e(Ee,{type:"file",open:!!f,initialUser:f,handleClose:()=>h(null),ID:(o==null?void 0:o.ID)||"",refetchAccessPeople:y})]})},Yo=({open:o,selectedFile:r,refetch:l,handleClose:t})=>{const{showErrorNotification:n,showSuccessNotification:v}=U(),[f,h]=m.useState((r==null?void 0:r.name.split(".")[0])||""),[a]=lo();return e(z,{open:o,title:"Rename File",onOk:async()=>{try{if(r!=null&&r.ID){const{data:b}=await a({variables:{fileID:r==null?void 0:r.ID,newName:f}});v((b==null?void 0:b.renameFile)||""),l(),t()}}catch(b){n(b.message)}},onCancel:t,children:e(te,{value:f,onChange:b=>h(b.target.value)})})},Zo=({open:o,movingFileID:r,handleClose:l,refetch:t})=>{const{showErrorNotification:n,showSuccessNotification:v}=U(),{rootFolderID:f,rootFolder:h}=K(),[a,C]=m.useState(h),[b]=so(),{data:S,loading:c}=ge({variables:{folderID:(a==null?void 0:a.ID)||f||""},skip:!(a!=null&&a.ID)&&!f,fetchPolicy:"cache-and-network"}),{data:y,loading:I}=me({variables:{folderID:(a==null?void 0:a.ID)||f||""},skip:!(a!=null&&a.ID)&&!f,fetchPolicy:"cache-and-network"}),w=()=>{(a==null?void 0:a.ID)!==(h==null?void 0:h.ID)&&C(a==null?void 0:a.rootFolder)};return e(z,{open:o,onOk:async()=>{try{const{data:u}=await b({variables:{fileID:r,targetFolderID:(a==null?void 0:a.ID)||""}});v((u==null?void 0:u.moveFileToNewFolder)||""),l(),t()}catch(u){n(u.message)}},onCancel:l,closable:!1,okText:"Move",title:x("div",{children:[(a==null?void 0:a.ID)!==(h==null?void 0:h.ID)&&e(E,{icon:e(be,{}),shape:"circle",className:"mr-4",onClick:w}),(a==null?void 0:a.ID)===(h==null?void 0:h.ID)?"My Storage":a==null?void 0:a.name]}),children:c||I?e("div",{className:"h-[40rem] flex justify-center items-center",children:e(_,{size:"large"})}):e(M,{className:"max-h-[40rem] overflow-auto",itemLayout:"horizontal",dataSource:[...(S==null?void 0:S.getFoldersOfFolder)??[],...(y==null?void 0:y.getFilesByFolder)??[]],renderItem:u=>e(M.Item,{children:x(E,{type:"text",className:"w-full text-left",disabled:!!(u!=null&&u.fileType),onClick:()=>C(u),children:[u!=null&&u.fileType?e(fe,{}):e(ke,{}),u.name]})})})})},ga=({files:o,handleClickItem:r,selectedItem:l,refetch:t,isStarred:n})=>{const{navigate:v}=co(),{showSuccessNotification:f,showErrorNotification:h}=U(),[a]=uo(),[C]=ho(),[b]=go(),[S]=mo(),[c,y]=m.useState(null),[I,w]=m.useState(null),[p,u]=m.useState(null),s=()=>{v(`/file/${l==null?void 0:l.ID}`)},i=d=>[{label:"Download",key:"1",icon:e(Oe,{}),onClick:()=>{ve(String(d.ID),"files",d.name)}},...n?[]:[{label:"Move to trash",key:"2",icon:e(Re,{}),onClick:async()=>{try{await a({variables:{fileID:d.ID}}),await t(),f("File moved to trash")}catch(g){h(g.message)}}},{label:"Share this file",key:"3",icon:e(pe,{}),onClick:()=>{y(d)}},{label:"Star this file",key:"4",icon:e(Q,{}),onClick:async()=>{try{const{data:g}=await C({variables:{fileID:d.ID}});g!=null&&g.starFile&&(await t(),f(g==null?void 0:g.starFile))}catch(g){h(g.message)}}},{label:"Rename",key:"5",icon:e(Ce,{}),onClick:()=>{w(d)}},{label:"Make a Copy",key:"6",icon:e(Ie,{}),onClick:async()=>{try{const{data:g}=await S({variables:{fileID:d.ID}});g!=null&&g.makeCopyOfFile&&(await t(),f(g==null?void 0:g.makeCopyOfFile))}catch(g){h(g.message)}}},{label:"Move to",key:"7",icon:e(Se,{icon:De}),onClick:()=>{u(d)}}],...n?[{label:"Un-star this file",key:"4",icon:e(Q,{}),onClick:async()=>{try{const{data:g}=await b({variables:{fileID:d.ID}});g!=null&&g.unstarFile&&(await t(),f(g==null?void 0:g.unstarFile))}catch(g){h(g.message)}}}]:[]],D=m.useMemo(()=>o.filter(d=>!d.isTrash),[o]);return x(B,{children:[e(oe,{className:"ml-7",children:D.map(d=>e(J,{menu:{items:i(d)},trigger:["contextMenu"],children:e(V,{className:"m-4",children:e(ye,{title:d.name,children:e(wo,{cover:bo(d),className:"w-[17rem]",onClick:()=>{l&&d.ID===l.ID?s():r(d)},children:e(ko,{className:`${(l==null?void 0:l.ID)===d.ID&&l.type==="file"?"bg-blue-100":""}`,children:e(N.Text,{className:"w-full font-semibold pointer-events-none truncate inline-block select-none",children:d.name})})})})})},d.ID))}),!!c&&e(Ko,{file:c,open:!!c,handleClose:()=>y(null)}),!!I&&e(Yo,{open:!!I,selectedFile:I,refetch:t,handleClose:()=>w(null)}),!!p&&e(Zo,{open:!!p,movingFileID:p.ID,handleClose:()=>u(null),refetch:t})]})},ea=({open:o,movingFolderID:r,handleClose:l,refetch:t})=>{const{showErrorNotification:n,showSuccessNotification:v}=U(),{rootFolderID:f,rootFolder:h}=K(),[a,C]=m.useState(h),[b]=fo(),{data:S,loading:c}=ge({variables:{folderID:(a==null?void 0:a.ID)||f||""},skip:!(a!=null&&a.ID)&&!f,fetchPolicy:"cache-and-network"}),{data:y,loading:I}=me({variables:{folderID:(a==null?void 0:a.ID)||f||""},skip:!(a!=null&&a.ID)&&!f,fetchPolicy:"cache-and-network"}),w=()=>{(a==null?void 0:a.ID)!==(h==null?void 0:h.ID)&&C(a==null?void 0:a.rootFolder)};return e(z,{open:o,onOk:async()=>{try{const{data:u}=await b({variables:{folderID:r,targetFolderID:(a==null?void 0:a.ID)||""}});v((u==null?void 0:u.moveFolder)||""),l(),t()}catch(u){n(u.message)}},onCancel:l,closable:!1,okText:"Move",title:x("div",{children:[(a==null?void 0:a.ID)!==(h==null?void 0:h.ID)&&e(E,{icon:e(be,{}),shape:"circle",className:"mr-4",onClick:w}),(a==null?void 0:a.ID)===(h==null?void 0:h.ID)?"My Storage":a==null?void 0:a.name]}),children:c||I?e("div",{className:"h-[40rem] flex justify-center items-center",children:e(_,{size:"large"})}):e(M,{className:"max-h-[40rem] overflow-auto",itemLayout:"horizontal",dataSource:[...(S==null?void 0:S.getFoldersOfFolder)??[],...(y==null?void 0:y.getFilesByFolder)??[]],renderItem:u=>e(M.Item,{children:x(E,{type:"text",className:"w-full text-left",disabled:!!(u!=null&&u.fileType),onClick:()=>C(u),children:[u!=null&&u.fileType?e(fe,{}):e(ke,{}),u.name]})})})})},oa=({open:o,selectedFolder:r,refetch:l,handleClose:t})=>{const{showErrorNotification:n,showSuccessNotification:v}=U(),[f,h]=m.useState((r==null?void 0:r.name)||""),[a]=yo();return e(z,{open:o,title:"Rename Folder",onOk:async()=>{try{if(r!=null&&r.ID){const{data:b}=await a({variables:{folderID:r==null?void 0:r.ID,name:f}});v((b==null?void 0:b.renameFolder)||""),l(),t()}}catch(b){n(b.message)}},onCancel:t,children:e(te,{value:f,onChange:b=>h(b.target.value)})})},aa=({open:o,handleClose:r,folder:l})=>{const{ID:t}=K(),{showErrorNotification:n,showSuccessNotification:v}=U(),[f,h]=m.useState(null),[a,C]=m.useState("Private"),[b,{loading:S}]=vo(),{data:c,refetch:y,loading:I}=po({variables:{folderID:l.ID},onCompleted:i=>{C(i.getPeopleWithAccessToFolder.isPublic?"Public":"Private")},fetchPolicy:"cache-and-network"}),w=()=>{h(null)},p=async i=>{if(C(i),i==="Private")try{await b({variables:{folderID:l.ID,isPublic:!1}}),v("Folder access changed to private"),C("Private"),y()}catch(D){n(D.message)}if(i==="Public")try{await b({variables:{folderID:l.ID,isPublic:!0}}),v("Folder access changed to public"),C("Public"),y()}catch(D){n(D.message)}},u=m.useMemo(()=>t===(c==null?void 0:c.getPeopleWithAccessToFolder.owner.ID)||(c==null?void 0:c.getPeopleWithAccessToFolder.sharedUsers.some(i=>String(i.ID)===t)),[c,t]);return x(B,{children:[e(z,{okButtonProps:{hidden:!0},centered:!0,open:o,title:"Share folder",cancelText:"Close",footer:x(B,{children:[e(E,{icon:e(Fe,{}),onClick:()=>{navigator.clipboard.writeText(`${window.location.origin}/folder/${l.ID}`),xe.success("Link copied to clipboard")},children:"Copy link"},"copy"),e(E,{type:"primary",onClick:r,children:"Done"},"done")]}),children:I||S?e("div",{className:"text-center",children:e(_,{})}):x(B,{children:[u&&e(ne,{query:ae,format:i=>({label:`${i.name} - ${i.email}`,value:i.ID}),onChange:h}),x("div",{className:"mt-4",children:[e(N.Text,{className:"font-bold",children:"Users can modify"}),(()=>{const i=c==null?void 0:c.getPeopleWithAccessToFolder.owner;return e(M,{children:x(M.Item,{children:[e(M.Item.Meta,{avatar:e(L,{size:"large",src:i!=null&&i.avatar?j(i.avatar):A(String(i==null?void 0:i.ID))}),title:i==null?void 0:i.name,description:i==null?void 0:i.email}),e(N.Text,{italic:!0,type:"secondary",className:"text-lg",children:"Owner"})]})})})(),e(M,{itemLayout:"horizontal",className:"max-h-96 overflow-y-auto",dataSource:c==null?void 0:c.getPeopleWithAccessToFolder.sharedUsers.filter(i=>i.ID!==c.getPeopleWithAccessToFolder.owner.ID),locale:{emptyText:" "},renderItem:i=>e(B,{children:x(M.Item,{children:[e(M.Item.Meta,{avatar:e(L,{size:"large",src:i!=null&&i.avatar?j(i.avatar):A(String(i==null?void 0:i.ID))}),title:i==null?void 0:i.name,description:i==null?void 0:i.email}),u&&e(X,{initialRole:$.EDITOR,userID:(i==null?void 0:i.ID)||"",ID:l.ID,type:"folder",refetchAccessPeople:y})]})})})]}),x("div",{children:[e(N.Text,{className:"font-bold",children:"Users can view"}),e(M,{itemLayout:"horizontal",className:"max-h-96 overflow-y-auto",dataSource:c==null?void 0:c.getPeopleWithAccessToFolder.readonlyUsers,renderItem:i=>x(M.Item,{children:[e(M.Item.Meta,{avatar:e(L,{size:"large",src:i.avatar?j(i.avatar):A(String(i.ID))}),title:i.name,description:i.email}),u&&e(X,{initialRole:$.VIEWER,userID:i.ID,ID:l.ID,type:"folder",refetchAccessPeople:y})]})})]}),x("div",{className:"flex flex-col",children:[e(N.Text,{className:"font-bold",children:"General Access"}),x(G.Group,{onChange:i=>p(i.target.value),value:a,buttonStyle:"solid",disabled:!u,children:[e(G.Button,{value:"Public",className:"w-1/2 text-center",children:"Public"}),e(G.Button,{value:"Private",className:"w-1/2 text-center",children:"Private"})]})]})]})}),!!f&&e(Ee,{type:"folder",open:!!f,initialUser:f,handleClose:w,ID:l.ID,refetchAccessPeople:y})]})},ta=Mo.div`
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
  border-radius: 8px;
`,{Text:na}=N,ma=({folders:o,selectedItem:r,handleClickFolder:l,refetch:t,isStarred:n})=>{const[v]=Co(),[f]=Io(),{showErrorNotification:h,showSuccessNotification:a}=U(),[C,b]=m.useState(null),[S,c]=m.useState(null),[y,I]=m.useState(null),[w]=So(),[p]=Do(),u=D=>[{label:"Download",key:"1",icon:e(Oe,{}),onClick:()=>{ve(String(D.ID),"folders",D.name)}},...n?[]:[{label:"Move to trash",key:"2",icon:e(Re,{}),onClick:async()=>{try{await v({variables:{folderID:D.ID}}),await t(),a("Folder moved to trash successfully")}catch(d){h(d.message)}}},{label:"Share this folder",key:"3",icon:e(pe,{}),onClick:()=>{b(D)}},{label:"Add to starred",key:"4",icon:e(Q,{}),onClick:async()=>{try{await w({variables:{folderID:D.ID}}),await t(),a("Folder added to starred successfully")}catch(d){h(d.message)}}},{label:"Rename",key:"5",icon:e(Ce,{}),onClick:async()=>{c(D)}},{label:"Make a copy",key:"6",icon:e(Ie,{}),onClick:async()=>{try{const{data:d}=await f({variables:{folderID:D.ID}});d!=null&&d.makeCopyOfFolder&&(await t(),a(d==null?void 0:d.makeCopyOfFolder))}catch(d){h(d.message)}}},{label:"Move to",key:"7",icon:e(Se,{icon:De}),onClick:async()=>{I(D)}}],...n?[{label:"Remove from starred",key:"5",icon:e(Q,{}),onClick:async()=>{try{const{data:d}=await p({variables:{folderID:D.ID}});a((d==null?void 0:d.unstarFolder)||""),t()}catch(d){h(d.message)}}}]:[]],s=()=>{b(null)},i=m.useMemo(()=>o.filter(D=>!D.isTrash),[o]);return x(B,{children:[e(oe,{className:"ml-7",children:i==null?void 0:i.map(D=>e(J,{menu:{items:u(D)},trigger:["contextMenu"],children:e(V,{className:"m-4",children:e(ye,{title:D.name,children:x(ta,{className:`p-3 flex flex-row items-center min-w-[17rem] max-w-[17rem] ${(r==null?void 0:r.ID)===D.ID&&r.type==="folder"?"bg-blue-100":"bg-white hover:bg-neutral-100"}`,onClick:()=>l==null?void 0:l(D),children:[e(xo,{className:"text-xl mr-3 flex items-center"}),e(na,{className:"inline-block truncate select-none font-semibold",children:D.name})]})})})},D.ID))}),!!C&&e(aa,{open:!!C,handleClose:s,folder:C}),!!S&&e(oa,{open:!!S,selectedFolder:S,refetch:t,handleClose:()=>c(null)}),!!y&&e(ea,{open:!!y,movingFolderID:y.ID,handleClose:()=>I(null),refetch:t})]})};export{ma as F,Ko as S,aa as a,ga as b};
